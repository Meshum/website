---
---

<div id="cookie-banner" class="cookie-banner hidden">
	<div class="cookie-banner-content">
		<div class="cookie-banner-inner">
			<!-- Gradient background -->
			<div class="absolute inset-0 bg-gradient-to-br from-primary/10 to-accent/10 rounded-2xl"></div>
			<div class="absolute inset-0 border border-white/10 rounded-2xl"></div>

			<div class="relative flex flex-col sm:flex-row gap-6 items-start sm:items-center justify-between">
				<div class="flex-1">
					<h3 class="text-lg font-semibold text-text-white mb-2">We value your privacy</h3>
					<p class="text-sm text-text-gray">
						Hey! We use analytics on this website to see what you guys (dis)like, by continuing to use
						this website you consent to us doing this. We don't do anything but generate pretty graphs
						with this information, promise!
						<a href="/privacy" class="text-primary hover:text-primary/80 underline">
							Read our privacy policy
						</a>
					</p>
				</div>
				<div class="flex gap-3 shrink-0">
					<button id="cookie-decline" class="btn-secondary whitespace-nowrap px-6 py-2 rounded-lg font-medium transition-colors">
						Decline
					</button>
					<button id="cookie-accept" class="btn-primary whitespace-nowrap px-6 py-2 rounded-lg font-medium">
						Accept
					</button>
				</div>
			</div>
		</div>
	</div>
</div>

<style>
	.cookie-banner {
		position: fixed;
		bottom: 0;
		left: 0;
		right: 0;
		z-index: 9999;
		padding: 1rem;
		animation: slideUp 0.3s ease-out;
	}

	.cookie-banner.hidden {
		display: none;
	}

	.cookie-banner-content {
		max-width: 1200px;
		margin: 0 auto;
	}

	.cookie-banner-inner {
		position: relative;
		padding: 1.5rem;
		backdrop-filter: blur(12px);
		background: rgba(17, 24, 39, 0.95);
		border-radius: 1rem;
		box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
	}

	.btn-secondary {
		background: transparent;
		border: 1px solid rgba(255, 255, 255, 0.1);
		color: var(--text-gray);
	}

	.btn-secondary:hover {
		background: rgba(255, 255, 255, 0.05);
		color: var(--text-white);
	}

	@keyframes slideUp {
		from {
			transform: translateY(100%);
			opacity: 0;
		}
		to {
			transform: translateY(0);
			opacity: 1;
		}
	}

	@media (max-width: 640px) {
		.cookie-banner-inner {
			padding: 1rem;
		}
	}
</style>

<script>
	// Check if user has already made a choice
	const CONSENT_KEY = 'meshum-cookie-consent';

	function getCookieConsent() {
		return localStorage.getItem(CONSENT_KEY);
	}

	function setCookieConsent(value: 'accepted' | 'declined') {
		localStorage.setItem(CONSENT_KEY, value);
		window.dispatchEvent(new CustomEvent('cookieConsentChange', { detail: { consent: value } }));
	}

	function showBanner() {
		const banner = document.getElementById('cookie-banner');
		if (banner) {
			banner.classList.remove('hidden');
		}
	}

	function hideBanner() {
		const banner = document.getElementById('cookie-banner');
		if (banner) {
			banner.classList.add('hidden');
		}
	}

	// Show banner if no consent has been given
	const consent = getCookieConsent();
	if (!consent) {
		showBanner();
	}

	// Handle accept button
	const acceptBtn = document.getElementById('cookie-accept');
	acceptBtn?.addEventListener('click', () => {
		setCookieConsent('accepted');
		hideBanner();
		// Reload to activate tracking scripts
		window.location.reload();
	});

	// Handle decline button
	const declineBtn = document.getElementById('cookie-decline');
	declineBtn?.addEventListener('click', () => {
		setCookieConsent('declined');
		hideBanner();
	});

	// Export function for other scripts to check consent
	(window as any).hasAnalyticsConsent = function() {
		return getCookieConsent() === 'accepted';
	};
</script>
